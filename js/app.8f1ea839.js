(function(e){function t(t){for(var r,a,i=t[0],c=t[1],u=t[2],p=0,d=[];p<i.length;p++)a=i[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},s=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/goodt/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"023e":function(e,t,n){"use strict";n("bb67")},"09ff":function(e,t,n){"use strict";n("e02f")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.isDataLoading?[e._v(" Загрузка ")]:[n("person-search",{model:{value:e.filterString,callback:function(t){e.filterString=t},expression:"filterString"}}),n("section",[e.filteredAndGroupedPersons.length?[n("ui-lazy-list",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.currentItemIndex,o=t.onItemLoad,s=t.root;return[e._l(e.filteredAndGroupedPersons,(function(t,a){var i=t[0],c=t[1];return[r>=a?n("ui-lazy",{key:i,attrs:{root:s},on:{load:function(e){return o(a)}}},[n("person-group",{attrs:{"group-name":i,persons:c},on:{edit:e.onPersonEdit}})],1):e._e()]}))]}}],null,!1,374804053)})]:[e._v(" Нет данных ")]],2),e.isPersonEditMode?n("person-edit",{attrs:{person:e.currentEditPerson},on:{change:e.changePersonData},model:{value:e.isPersonEditMode,callback:function(t){e.isPersonEditMode=t},expression:"isPersonEditMode"}}):e._e()]],2)},s=[],a=n("1da1"),i=n("2909"),c=(n("96cf"),n("4de4"),n("d3b7"),n("b0c0"),n("99af"),n("ac1f"),n("1276"),n("7db0"),n("caad"),n("2532"),n("4fad"),n("159b"),n("6062"),n("3ca3"),n("ddb0"),n("a434"),n("d4ec")),u=n("bee2"),l=n("ade3"),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.baseUrl,r=void 0===n?"https://61adfd3ea7c7f3001786f510.mockapi.io/":n;return Object(c["a"])(this,e),Object(l["a"])(this,"_instance",null),e._instance||(this.options={baseUrl:r},e._instance=this),e._instance}return Object(u["a"])(e,[{key:"getPersons",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.options.baseUrl+"person",{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.next=8,this.getComments();case 8:return r=e.sent,n.forEach((function(e){e.comments=r.filter((function(t){var n=1===t.personId.split(" ").length?t.personId:t.personId.split(" ")[1];return+n===+e.id}))})),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getComments",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.options.baseUrl+"comment",{method:"GET"});case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),e}(),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"person-group"},[n("h2",{staticClass:"person-group__title"},[e._v(e._s(e.groupName))]),n("div",{staticClass:"person-group__list"},e._l(e.persons,(function(t){return n(e.getComponent(),{key:t.id,tag:"component",attrs:{person:t},on:{edit:function(n){return e.onPersonEdit(t)}}})})),1)])},f=[],m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card",class:e.classObject},[n("div",{staticClass:"card__avatar"},[n("avatar",{attrs:{url:e.person.avatar}}),e.person.comments.length?n("div",{staticClass:"card__comments-count"},[e._v(" "+e._s(e.person.comments.length)+" ")]):e._e()],1),n("div",{staticClass:"card__inner"},[n("div",{staticClass:"card__name",attrs:{title:e.person.name}},[e._v(" "+e._s(e.person.name)+" ")]),n("div",{staticClass:"card__email",attrs:{title:e.person.email}},[e._v(" "+e._s(e.person.email)+" ")])]),n("div",{staticClass:"card__controls"},[n("span",{staticClass:"action-btn card__active-btn",on:{click:e.onPersonEdit}},[e._v(" edit ")])])])},h=[],v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("img",{ref:"img",staticClass:"avatar",attrs:{src:e.imgUrl,alt:"avatar"},on:{error:e.onError,load:e.onLoad}})},g=[],_={props:{url:{type:String}},data:function(){return{imgUrl:"",isImageLoad:!1}},watch:{url:{handler:function(e){this.imgUrl=e},immediate:!0}},mounted:function(){var e=this;setTimeout((function(){e.isImageLoad||e.onError()}),2e3)},methods:{onError:function(){this.imgUrl="/goodt/avatar.webp"},onLoad:function(){this.isImageLoad=!0}}},b=_,y=(n("ca40"),n("2877")),P=Object(y["a"])(b,v,g,!1,null,"215370ea",null),C=P.exports,x={name:"PersonCard",components:{Avatar:C},props:{person:{type:Object,required:!0}},inject:{theme:{default:"light"}},methods:{onPersonEdit:function(e){this.$emit("edit",e)}},computed:{classObject:function(){return{card_theme_light:"light"===this.theme,card_theme_dark:"dark"===this.theme}}}},D=x,O=(n("7a68"),Object(y["a"])(D,m,h,!1,null,"70f5b3c8",null)),j=O.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("person-card",{attrs:{person:e.person},on:{edit:function(t){return e.$emit("edit",t)}}})},E=[],I={name:"PersonCardManager",components:{PersonCard:j},props:{person:{type:Object,required:!0}},provide:function(){return{theme:"dark"}}},k=I,S=Object(y["a"])(k,w,E,!1,null,"055e002e",null),$=S.exports,L={name:"PersonGroup",components:{PersonCard:j,PersonCardManager:$},data:function(){return{componentsInfo:{manager:$},defaultComponent:j}},props:{groupName:{type:String,required:!0},persons:{type:Array,required:!0}},methods:{onPersonEdit:function(e){this.$emit("edit",e)},getComponent:function(){var e=this.componentsInfo[this.groupName.toLowerCase()];return e||this.defaultComponent}}},M=L,z=(n("e66c"),Object(y["a"])(M,d,f,!1,null,"6502402c",null)),U=z.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ui-popup",{scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Имя Фамилия Сотрудника")])]},proxy:!0},{key:"body",fn:function(){return[n("form",{staticClass:"form",on:{submit:e.saveData}},[n("div",{staticClass:"form__inner"},[n("div",{staticClass:"form__elem"},[n("label",{staticClass:"form__label"},[e._v(" name ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.personData.name,expression:"personData.name"}],attrs:{type:"text"},domProps:{value:e.personData.name},on:{input:[function(t){t.target.composing||e.$set(e.personData,"name",t.target.value)},e.onPersonDataChange]}})]),n("div",{staticClass:"form__elem"},[n("label",{staticClass:"form__label"},[e._v(" email ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.personData.email,expression:"personData.email"}],attrs:{type:"text"},domProps:{value:e.personData.email},on:{input:[function(t){t.target.composing||e.$set(e.personData,"email",t.target.value)},e.onPersonDataChange]}})]),n("div",{staticClass:"form__elem"},[n("label",{staticClass:"form__label"},[e._v(" position ")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.personData.position,expression:"personData.position"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.personData,"position",t.target.multiple?n:n[0])},e.onPersonDataChange]}},e._l(e.positions,(function(t){return n("option",{key:t,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])})),0)])]),n("div",{staticClass:"form__buttons"},[n("button",{staticClass:"outline",attrs:{type:"button"},on:{click:e.checkDataChange}},[e._v(" Отменить ")]),n("button",{attrs:{type:"submit",disabled:!e.isPersonDataChange}},[e._v(" Сохранить ")])])]),n("ui-popup",{scopedSlots:e._u([{key:"header",fn:function(){return[n("h3",[e._v("Точно хотите отменить изменения")])]},proxy:!0},{key:"footer",fn:function(t){var r=t.hide;return[n("div",{staticClass:"form__buttons"},[n("button",{staticClass:"outline",on:{click:e.closeModal}},[e._v(" Да ")]),n("button",{on:{click:r}},[e._v(" Нет ")])])]}}]),model:{value:e.confirmChangePopupDisplay,callback:function(t){e.confirmChangePopupDisplay=t},expression:"confirmChangePopupDisplay"}})]},proxy:!0}]),model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})},q=[],N=(n("e9c4"),n("466d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.value?n("div",{staticClass:"popup"},[n("div",{staticClass:"dialog"},[n("div",{staticClass:"dialog-header"},[e._t("header")],2),n("div",{staticClass:"dialog-body"},[e._t("body")],2),n("div",{staticClass:"dialog-footer"},[e._t("footer",null,null,{hide:e.hide})],2)])]):e._e()}),G=[],R={name:"UiPopup",props:{value:{type:Boolean,required:!0}},methods:{hide:function(){this.$emit("input",!1)},show:function(){this.$emit("input",!0)}}},T=R,Z=(n("09ff"),Object(y["a"])(T,N,G,!1,null,"072a4169",null)),J=Z.exports,V={name:"PersonEdit",components:{UiPopup:J},props:{value:{type:Boolean,required:!0},person:{type:Object,required:!0}},data:function(){return{confirmChangePopupDisplay:!1,isPersonDataChange:!1,personData:null,positions:this.getPositions()}},created:function(){this.personData=JSON.parse(JSON.stringify(this.person))},inject:["getPositions"],methods:{saveData:function(e){e.preventDefault(),this.isPersonDataChange&&this.isFormValid&&(this.$emit("change",this.personData),this.$emit("input",!1))},checkDataChange:function(){this.isPersonDataChange?this.confirmChangePopupDisplay=!0:this.closeModal()},closeModal:function(){this.$emit("input",!1)},onPersonDataChange:function(){this.isPersonDataChange=!0}},computed:{isFormValid:function(){if(!this.personData)return!1;var e=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},t=function(e){return String(e).toLowerCase().match(/[A-Za-zА-ЯЁа-яё][A-Za-zА-ЯЁа-яё][\S]*\s[A-Za-zА-ЯЁа-яё][A-Za-zА-ЯЁа-яё][\S]*/gi)},n=this.personData,r=n.name,o=n.email,s=n.position;return e(o)?s?!!t(r)||(console.log("name"),!1):(console.log("position"),!1):(console.log("email"),!1)}}},B=V,F=(n("023e"),Object(y["a"])(B,A,q,!1,null,"427141b8",null)),H=F.exports,K=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-bar"},[n("input",{staticClass:"search-bar-input",attrs:{placeholder:"Search by first/last",type:"text"},domProps:{value:e.value},on:{input:e.changeValue}})])},Q=[],W={name:"PersonSearch",props:{value:{type:String,required:!0}},methods:{changeValue:function(e){this.$emit("input",e.target.value)}}},X=W,Y=(n("e921"),Object(y["a"])(X,K,Q,!1,null,"0e6b49d2",null)),ee=Y.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"list",staticStyle:{display:"flex","flex-direction":"column"}},[e._t("default",null,null,{onItemLoad:e.onItemLoad,currentItemIndex:e.currentItemIndex,root:e.$refs.list})],2)},ne=[],re={name:"UiLazyList",data:function(){return{currentItemIndex:0}},methods:{onItemLoad:function(e){null!==this.currentItemIndex||0!==e?e===this.currentItemIndex&&this.changeCurrentItemIndex():this.changeCurrentItemIndex()},changeCurrentItemIndex:function(){this.currentItemIndex+=1}}},oe=re,se=Object(y["a"])(oe,te,ne,!1,null,"82011454",null),ae=se.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"lazy"},[e._t("default")],2)},ce=[],ue={name:"UiLazy",props:["root"],data:function(){var e=this;return{options:{root:this.root,rootMargin:"0px",threshold:.1},observer:new IntersectionObserver((function(t){t[0].isIntersecting&&e.onLoad()}),this.options)}},mounted:function(){this.observer.observe(this.$refs.lazy)},beforeDestroy:function(){this.observer.unobserve(this.$refs.lazy)},methods:{onLoad:function(){this.$emit("load")}}},le=ue,pe=Object(y["a"])(le,ie,ce,!1,null,"192e461e",null),de=pe.exports,fe={name:"App",components:{UiLazy:de,UiLazyList:ae,PersonSearch:ee,PersonEdit:H,PersonGroup:U},data:function(){return{persons:[],positions:[],filterString:"",isPersonEditMode:!1,currentEditPerson:null,isDataLoading:!0}},created:function(){this.fetchPersons()},provide:function(){var e=this;return{getPositions:function(){return e.positions}}},computed:{filteredPersons:function(){var e=this;return this.filterString?this.persons.filter((function(t){var n=t.name,r=t.email,o=[].concat(Object(i["a"])(n.split(" ")),Object(i["a"])(r.split("@")));return o.find((function(t){return t.toLowerCase().includes(e.filterString.toLowerCase())}))})):this.persons},filteredAndGroupedPersons:function(){var e=this.filteredPersons.reduce((function(e,t){return e[t.position]=e[t.position]||[],e[t.position].push(t),e}),{});return Object.entries(e)}},methods:{fetchPersons:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(new p).getPersons();case 2:e.persons=t.sent,e.isDataLoading=!1,n=[],e.persons.forEach((function(e){return n.push(e.position)})),e.positions=Object(i["a"])(new Set(n));case 7:case"end":return t.stop()}}),t)})))()},onPersonEdit:function(e){this.currentEditPerson=e,this.isPersonEditMode=!0},changePersonData:function(e){var t=this.persons.find((function(t){return t.id===e.id})),n=this.persons.indexOf(t);this.persons.splice(n,1,e)}}},me=fe,he=Object(y["a"])(me,o,s,!1,null,"4998cfae",null),ve=he.exports;n("fc1f");r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(ve)}}).$mount("#app")},"62ca":function(e,t,n){},"674e":function(e,t,n){},"7a68":function(e,t,n){"use strict";n("7f27")},"7f27":function(e,t,n){},bb67:function(e,t,n){},ca40:function(e,t,n){"use strict";n("f989")},e02f:function(e,t,n){},e66c:function(e,t,n){"use strict";n("674e")},e921:function(e,t,n){"use strict";n("62ca")},f989:function(e,t,n){},fc1f:function(e,t,n){}});
//# sourceMappingURL=app.8f1ea839.js.map